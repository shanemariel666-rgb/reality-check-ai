<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reality Check — Verifier</title>
  <link rel="icon" type="image/png" href="/static/logo.png">
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="shell">
    <header class="top">
      <img src="/static/logo.png" alt="Reality Check" class="logo">
      <div class="title">Reality Check</div>
    </header>

    <main class="card">
      <h1>Verify images, video & text</h1>
      <p class="lead">Drop media or paste text to check for AI-generation or tampering. Built for journalists.</p>

      <form id="analyzeForm">
        <div class="row">
          <input id="file" name="file" type="file" accept="image/*,video/*">
        </div>
        <div class="row">
          <textarea id="text" name="text" placeholder="Paste text, caption or claim to check..."></textarea>
        </div>
        <div class="row actions">
          <button id="analyzeBtn" type="submit">Analyze</button>
        </div>
      </form>

      <div id="status" class="status" hidden></div>
      <div id="result" class="result" hidden></div>
    </main>

    <footer class="foot">For press verification • Add accounts & tracking later</footer>
  </div>

  <script>
    const form = document.getElementById('analyzeForm');
    const statusEl = document.getElementById('status');
    const resultEl = document.getElementById('result');

    function showStatus(text) {
      statusEl.hidden = false; resultEl.hidden = true;
      statusEl.innerText = text;
    }
    function showResult(obj) {
      statusEl.hidden = true; resultEl.hidden = false;
      resultEl.innerHTML = '<pre>' + JSON.stringify(obj, null, 2) + '</pre>';
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      statusEl.hidden = true; resultEl.hidden = true;

      const file = document.getElementById('file').files[0];
      const text = document.getElementById('text').value.trim();
      if (!file && !text) { alert('Choose a file or paste text first'); return; }

      showStatus('Uploading & analyzing — please wait...');

      const fd = new FormData();
      if (file) fd.append('file', file);
      if (text) fd.append('text', text);

      try {
        const res = await fetch('/api/analyze', { method: 'POST', body: fd });
        const j = await res.json();
        if (!res.ok) {
          showResult(j);
        } else {
          showResult(j);
        }
      } catch (err) {
        showResult({ error: 'Network or server error', message: err.message });
      }
    });
  </script>
</body>
</html>
